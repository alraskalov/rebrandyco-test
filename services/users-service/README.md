# Микросервис пользователей

## Описание

Users Service — это микросервис, который управляет пользователями и их данными, такими как имя пользователя, электронная почта, роль и аватар. Микросервис взаимодействует с API Gateway для обработки запросов, связанных с пользователями, таких как:

- Регистрация нового пользователя.
- Авторизация пользователя (проверка учетных данных).
- Получение данных о пользователе.
- Обновление аватара пользователя.

## Структура

- **auth.controller.ts** — Контроллер для регистрации и логина пользователей.
- **users.controller.ts** — Контроллер для обработки запросов о пользователях.
- **auth.service.ts** — Логика авторизации.
- **users.service.ts** — Логика работы с пользователями, включая обновление аватара и получение данных о пользователях.
- **auth.entity.ts** — Сущность пользователя, которая описывает структуру данных в СУБД PostgreSQL.

## Зависимости

- **NestJS** — Основной фреймворк для создания серверных приложений.
- **@nestjs/typeorm** — Для работы с базой данных через TypeORM.
- **typeorm** — ORM для работы с базой данных.
- **bcryptjs** — Для хеширования паролей.

## Как работает Users Service

1. **Регистрация пользователя**:

   - Пользователь может зарегистрироваться через запрос к микросервису с передачей необходимых данных (email, username, password, role (default: simple), avatarUrl (optional)).
   - После успешной регистрации, пароль сохраняется в базе данных в виде хеша (используется bcryptjs).

2. **Авторизация пользователя**:

   - Пользователь может войти в систему, отправив свои учетные данные (email и password).
   - Если данные верны, то в API Gateway генерируется JWT токен, который отправляется пользователю для дальнейших запросов.

3. **Получение данных о пользователе**:

   - Запросы от API Gateway на получение данных о пользователе обрабатываются микросервисом, используя `findById` метод для поиска по ID.
   - Информация о пользователе возвращается без пароля для безопасности пользователя.

4. **Обновление аватара**:

   - Метод `updateAvatar` обновляет ссылку на аватар в базе данных после успешной загрузки файла.
   - Ссылка на аватар хранится в поле `avatarUrl` и может быть использована для отображения изображения.

## Как запустить

1. Установите зависимости:

   ```bash
   npm install
   ```

2. Запустите приложение:

   ```bash
   npm run start
   ```
